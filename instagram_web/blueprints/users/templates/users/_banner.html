{% extends '_layout.html' %}

{% block title %}
{{user.username}}'s Profile
{% endblock %}

{% block content %}

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="text-center alert alert-secondary mb-0" role="alert">
    {% for message in messages %}
    <span>{{ message }}</span>
    {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<div class="text-center">
  <img class="xyz_avatar mt-4" src="{{ user.avatar_url }}"></img>
</div>
<h3 class="text-center text-dark mt-2 py-2 lead user_page_username">{{ user.username }}</h3>

<div class="text-center mb-3 mx-auto" style="max-width: 500px;">
{% if current_user.is_authenticated and current_user in user.followers() %}
    <form action="{{ url_for('users.unfollow', id=user.id) }}" method="POST" id="unfollow_form">
      <input type="hidden" name="next" value="{{ url_for('users.show', username=user.username) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    </form>
    <button class="following-button user_page_ul_button user_page_ul_unfollow w-50" form="unfollow_form" value="Submit">
      <!-- <span id="following-span-1">Following</span> -->
      <span id="following-span-2">Unfollow</span>
    </button>
{% elif current_user.is_authenticated and current_user == user %}
      <form action="{{ url_for('users.edit') }}" method="GET" id="edit_form">
        <!-- <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/> -->
      </form>
      <button class="btn btn-sm btn-success w-50" form="edit_form" value="Submit">Change Avatar</button>
{% else %}
      <form action="{{ url_for('users.follow', id=user.id) }}" method="POST" id="follow_form">
        <input type="hidden" name="next" value="{{ url_for('users.show', username=user.username) }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
      </form>
      <button class="user_page_ul_button user_page_ul_follow w-50" form="follow_form" value="Submit">Follow</button>
{% endif %}
</div>

<div class="d-flex justify-content-center align-items-center">
    <div class="px-3 {% block usertab1 %} {% endblock %}">
        <a class="text-decoration-none user_page_stat" href="{{ url_for('users.show', username=user.username) }}">
          <span class="text-dark lead d-block text-center user_page_stat_number">{{ user.posts|length }}</span>
          <span class="text-dark lead d-block text-center">Post{% if user.posts|length != 1 %}s{% endif %}</span>
        </a>
        <div class="user_page_tab_bottom"></div>
      </div>
  <div class="px-3 border-left border-right {% block usertab2 %} {% endblock %}">
    <a class="text-decoration-none user_page_stat" href="{{ url_for('users.show_followers', username=user.username) }}">
      <span class="text-dark lead d-block text-center user_page_stat_number">{{ user.related_to|length }}</span>
      <span class="text-dark lead d-block text-center">Follower{% if user.related_to|length != 1 %}s{% endif %}</span>
    </a>
    <div class="user_page_tab_bottom"></div>
  </div>
  <div class="px-3 {% block usertab3 %} {% endblock %}">
      <a class="text-decoration-none user_page_stat" href="{{ url_for('users.show_following', username=user.username) }}">
        <span class="text-dark lead d-block text-center user_page_stat_number">{{ user.relationships|length }}</span>
        <span class="text-dark lead d-block text-center">Following</span>
      </a>
      <div class="user_page_tab_bottom"></div>
    </div>

</div>

{% block usercontent %}

{% endblock %}

{% endblock %}

